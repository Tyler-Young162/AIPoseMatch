# 系统托盘模式使用说明

## 功能说明

系统托盘模式允许程序在后台运行，不显示预览窗口，只显示系统托盘图标。可以通过双击图标或右键菜单打开预览窗口。

## 启动方式

### 方式1：使用虚拟环境（推荐）⭐

```bash
# 激活虚拟环境
.venv\Scripts\activate

# 运行托盘模式
python run_with_tray.py
```

或者使用一键启动脚本：

**Windows PowerShell:**
```powershell
.\start_tray.ps1
```

**Windows CMD:**
```cmd
start_tray.bat
```

### 方式2：直接运行（需要先安装依赖）

如果未使用虚拟环境，需要先安装依赖：

```bash
# 安装依赖
pip install -r requirements.txt

# 然后运行
python run_with_tray.py
```

### 默认启动（托盘模式）

启动后：
- ✅ 只显示系统托盘图标，不打开预览窗口
- ✅ 双击图标：打开单摄像头预览窗口
- ✅ 右键图标：显示菜单
  - 打开单摄像头窗口
  - 打开双摄像头窗口
  - 退出

### 启动时自动打开双摄像头窗口

```bash
python run_with_tray.py --dual
```

### 不使用托盘，直接打开窗口

```bash
# 单摄像头
python run_with_tray.py --no-tray

# 双摄像头
python run_with_tray.py --no-tray --dual
```

## 系统托盘图标操作

### 双击图标
- 打开单摄像头预览窗口
- 如果窗口已打开，则不会重复打开

### 右键菜单
- **打开单摄像头窗口**：打开单个摄像头的预览窗口
- **打开双摄像头窗口**：打开双摄像头比赛模式
- **退出**：退出整个程序

## 安装依赖

确保已安装系统托盘依赖：

```bash
pip install pystray
```

或者安装所有依赖：

```bash
pip install -r requirements.txt
```

## 注意事项

1. **首次运行**：如果提示缺少pystray，程序会提示安装命令
2. **窗口管理**：可以同时打开多个窗口（单摄像头和双摄像头）
3. **退出程序**：必须通过托盘右键菜单退出，关闭窗口不会退出程序
4. **后台运行**：程序在后台持续运行，需要手动退出

## 故障排除

### 托盘图标不显示
- 检查是否安装了pystray: `pip install pystray`
- 检查系统托盘区域是否有足够空间
- 尝试重启程序

### 双击图标无响应
- 尝试使用右键菜单打开窗口
- 检查是否有错误信息输出到控制台

### 窗口无法打开
- 检查摄像头是否可用
- 检查是否有其他程序占用摄像头
- 查看控制台错误信息

