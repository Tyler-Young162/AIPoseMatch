# 双摄像头比赛模式使用说明

## 功能说明

双摄像头模式允许同时打开两个摄像头（摄像头0和摄像头1），两个窗口共享同一个目标姿态，可以同时进行姿态比对，实现比赛功能。

## 启动方式

### 方式1：直接启动双摄像头模式

```bash
python run_dual_camera.py
```

### 方式2：通过系统托盘启动

```bash
# 启动托盘并自动打开双摄像头窗口
python run_with_tray.py --dual

# 或启动托盘，手动通过菜单选择
python run_with_tray.py
# 然后右键点击托盘图标，选择"打开双摄像头窗口"
```

### 方式3：不使用托盘直接启动

```bash
python run_dual_camera.py --config config.yaml
```

## 功能特点

- ✅ **两个独立窗口**：每个摄像头对应一个独立预览窗口
- ✅ **共享目标姿态**：两个窗口使用相同的目标姿态图片进行比对
- ✅ **同步切换**：在一个窗口中按左右箭头键或A/D键，两个窗口同步切换目标姿态
- ✅ **独立评分**：每个窗口独立显示各自的匹配评分（0-100分）
- ✅ **颜色编码**：每个窗口的骨骼颜色独立显示匹配程度

## 键盘控制

### 单个窗口控制
- `Q`: 关闭当前窗口（另一个窗口继续运行）

### 全局控制（任一窗口操作，两个窗口同步）
- `←` / `→`: 切换到上一个/下一个目标姿态
- `A` / `D`: 切换到上一个/下一个目标姿态（备用方案）

## 窗口显示内容

每个窗口显示：
1. **摄像头标识**：左下角显示"摄像头 0"或"摄像头 1"
2. **目标姿态预览**：右上角显示当前目标姿态图片
3. **匹配评分**：右上角显示实时匹配评分（0-100分）
4. **骨骼显示**：颜色编码的骨骼，蓝色（不匹配）→ 黄色（匹配）
5. **抠像效果**：绿色背景的抠像结果（如果启用）

## 系统托盘功能

如果使用 `run_with_tray.py` 启动：

- **默认行为**：程序启动时只显示系统托盘图标，不打开窗口
- **打开窗口**：右键点击托盘图标，选择：
  - "打开单摄像头窗口" - 打开单个摄像头预览
  - "打开双摄像头窗口" - 打开双摄像头比赛模式
- **退出程序**：右键点击托盘图标，选择"退出"

## 注意事项

1. **摄像头要求**：需要至少两个可用的摄像头（设备ID 0和1）
2. **性能要求**：双摄像头模式会消耗更多系统资源，确保有足够的CPU/GPU性能
3. **窗口关闭**：关闭一个窗口不会影响另一个窗口，两个窗口相互独立
4. **目标姿态同步**：两个窗口始终使用相同的目标姿态进行比对，确保比赛公平性

## 故障排除

### 摄像头初始化失败
- 检查是否有两个可用的摄像头
- 确认摄像头没有被其他程序占用
- 尝试修改 `config.yaml` 中的 `device_id` 配置

### 窗口无响应
- 检查是否有足够的系统资源
- 尝试关闭其他占用资源的程序
- 降低摄像头分辨率（在config.yaml中调整）

### 系统托盘不显示
- 确保已安装pystray: `pip install pystray`
- 如果不使用托盘功能，直接使用 `run_dual_camera.py`

